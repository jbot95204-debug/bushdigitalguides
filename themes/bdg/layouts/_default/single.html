{{ define "main" }}

{{ if eq .Section "blog" }}
<!-- Blog Post -->
<section class="post-header">
  <div class="section-label" style="text-align:center; margin-bottom:8px;">{{ with .Params.book }}{{ . }}{{ else }}BLOG{{ end }}</div>
  <h1>{{ .Title }}</h1>
  <div class="post-meta">{{ .Date.Format "2 January 2006" }} Â· {{ .ReadingTime }} min read</div>
</section>
<article class="post-content">
  {{ .Content }}
  
  {{ with .Params.book }}
  <div class="post-book-cta">
    <div class="emoji">ğŸ“š</div>
    <div>
      <strong>Want the full picture?</strong>
      This post is a taste of what's in <em>{{ . }}</em>. The book goes deeper â€” with more data, more strategies, and zero filler.
      {{ with $.Params.bookLink }}<br><a href="{{ . }}">See the full book â†’</a>{{ end }}
    </div>
  </div>
  {{ end }}

  <!-- Related Posts -->
  {{ $related := first 3 (where (.Site.RegularPages.Related .) "Section" "blog") }}
  {{ with $related }}
  <div class="related-posts">
    <h3>You might also like</h3>
    <ul>
      {{ range . }}
      <li><a href="{{ .RelPermalink }}">{{ .Title }}</a> â€” {{ .ReadingTime }} min read</li>
      {{ end }}
    </ul>
  </div>
  {{ end }}
</article>

{{ else if eq .Section "books" }}
<!-- Book Landing Page -->
<section class="book-hero" style="background: linear-gradient(145deg, {{ with .Params.color }}{{ . }}{{ else }}#111{{ end }}, {{ with .Params.colorEnd }}{{ . }}{{ else }}#333{{ end }});">
  <div class="container">
    <div class="book-hero-inner">
      <div class="book-hero-text">
        <h1>{{ .Title }}</h1>
        <p class="subtitle">{{ .Params.subtitle }}</p>
        <div class="meta">
          <span>ğŸ“– {{ .Params.words }} words</span>
          <span>ğŸ“‘ {{ .Params.chapters }} chapters</span>
          <span>âœï¸ Bush Digital Guides</span>
        </div>
        {{ with .Params.kdpLink }}<a href="{{ . }}" class="btn btn-accent">Buy on Amazon â€” {{ $.Params.price }}</a>{{ end }}
      </div>
      <div>
        <div class="book-cover-placeholder">
          {{ .Params.emoji }}
        </div>
      </div>
    </div>
  </div>
</section>
<section style="padding: 60px 0;">
  <div class="narrow">
    {{ .Content }}
  </div>
</section>

{{ else }}
<!-- Default Page -->
<section class="about-header">
  <div class="section-label" style="text-align:center; margin-bottom:8px;">{{ upper .Title }}</div>
  <h1 style="text-align:center;">{{ .Title }}</h1>
</section>
<section style="padding: 40px 0 80px;">
  <div class="narrow">
    {{ .Content }}
  </div>
</section>
{{ end }}

{{ end }}
